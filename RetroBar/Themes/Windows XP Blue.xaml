<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:system="clr-namespace:System;assembly=mscorlib">

    <system:Double x:Key="TaskbarHeight">30</system:Double>
    <system:Double x:Key="TaskbarRowHeight">30</system:Double>
    <system:Double x:Key="TaskbarUnlockedSize">4</system:Double>
    <Thickness x:Key="TaskButtonMargin" />
    <FontWeight x:Key="SetTimeMenuItemWeight">Normal</FontWeight>

    <SolidColorBrush x:Key="HighlightBackground" Color="#316AC5" />
    <SolidColorBrush x:Key="HighlightForeground" Color="#FFFFFF" />

    <SolidColorBrush x:Key="MenuBackground" Color="#FFFFFF" />
    <SolidColorBrush x:Key="MenuForeground" Color="#000000" />
    <SolidColorBrush x:Key="MenuDisabledForeground" Color="#ACA899" />

    <LinearGradientBrush x:Key="TaskbarBackground"
                         StartPoint="0,0"
                         EndPoint="0,1">
        <GradientStop Color="#3888e9"
                      Offset="0.0" />
        <GradientStop Color="#4993e6"
                      Offset="0.05" />
        <GradientStop Color="#2257d5"
                      Offset="0.18" />
        <GradientStop Color="#2663e0"
                      Offset="0.9" />
        <GradientStop Color="#1941a5"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskbarBackgroundTall"
                         StartPoint="0,0"
                         EndPoint="0,1">
        <GradientStop Color="#3888e9"
                      Offset="0.0" />
        <GradientStop Color="#4993e6"
                      Offset="0.05" />
        <GradientStop Color="#2257d5"
                      Offset="0.18" />
        <GradientStop Color="#2663e0"
                      Offset="0.9" />
        <GradientStop Color="#1941a5"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskbarVerticalBackground"
                         StartPoint="0,0"
                         EndPoint="1,0">
        <GradientStop Color="#3888e9"
                      Offset="0.0" />
        <GradientStop Color="#4993e6"
                      Offset="0.01" />
        <GradientStop Color="#2257d5"
                      Offset="0.05" />
        <GradientStop Color="#2663e0"
                      Offset="0.95" />
        <GradientStop Color="#1941a5"
                      Offset="1.0" />
    </LinearGradientBrush>
    <SolidColorBrush x:Key="TaskbarBorder" Color="#3168d5" />

    <SolidColorBrush x:Key="TaskbarUnlockedBorderTop" Color="#3b72be" />
    <LinearGradientBrush x:Key="TaskbarUnlockedBottomBorder"
                         MappingMode="Absolute"
                         StartPoint="0,0"
                         EndPoint="0,3">
        <GradientStop Color="#368beb"
                      Offset="0.0" />
        <GradientStop Color="#307be5"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskbarUnlockedTopBorder"
                         StartPoint="0,1"
                         EndPoint="0,0.97">
        <GradientStop Color="#368beb"
                      Offset="0.0" />
        <GradientStop Color="#307be5"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskbarUnlockedLeftBorder"
                         StartPoint="1,0"
                         EndPoint="0.97,0">
        <GradientStop Color="#368beb"
                      Offset="0.0" />
        <GradientStop Color="#307be5"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskbarUnlockedRightBorder"
                         MappingMode="Absolute"
                         StartPoint="0,0"
                         EndPoint="3,0">
        <GradientStop Color="#368beb"
                      Offset="0.0" />
        <GradientStop Color="#307be5"
                      Offset="1.0" />
    </LinearGradientBrush>

    <SolidColorBrush x:Key="TrayTopBottomBorder" Color="#095bc9" />
    <SolidColorBrush x:Key="TrayLeftBorder1" Color="#8a000000" />
    <SolidColorBrush x:Key="TrayLeftBorder2" Color="#22b9e5" />
    <SolidColorBrush x:Key="TrayLeftBorder3" Color="#22c4f4" />
    <SolidColorBrush x:Key="TrayLeftBorder4" Color="#3822c4f4" />
    <LinearGradientBrush x:Key="TrayBackground"
                         StartPoint="0,0"
                         EndPoint="0,1">
        <GradientStop Color="#16adf0"
                      Offset="0.0" />
        <GradientStop Color="#19b9f3"
                      Offset="0.05" />
        <GradientStop Color="#1290e8"
                      Offset="0.18" />
        <GradientStop Color="#0d8dea"
                      Offset="0.6" />
        <GradientStop Color="#0fa0ef"
                      Offset="0.9" />
        <GradientStop Color="#1582dc"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TrayVerticalBackground"
                         StartPoint="0,0"
                         EndPoint="1,0">
        <GradientStop Color="#16adf0"
                      Offset="0.0" />
        <GradientStop Color="#19b9f3"
                      Offset="0.01" />
        <GradientStop Color="#1290e8"
                      Offset="0.05" />
        <GradientStop Color="#0d8dea"
                      Offset="0.6" />
        <GradientStop Color="#0fa0ef"
                      Offset="0.95" />
        <GradientStop Color="#1582dc"
                      Offset="1.0" />
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="TrayToggleBorder"
                         StartPoint="0,0"
                         EndPoint="1,1">
        <GradientStop Color="#10225e"
                      Offset="0.2" />
        <GradientStop Color="#ced6e6"
                      Offset="0.8" />
    </LinearGradientBrush>
    <RadialGradientBrush x:Key="TrayToggleBackground"
                         GradientOrigin="0.15,0.15"
                         RadiusX="0.75"
                         RadiusY="0.7">
        <GradientStop Color="#8ed6f9"
                      Offset="0.0" />
        <GradientStop Color="#0671eb"
                      Offset="0.9" />
    </RadialGradientBrush>
    <RadialGradientBrush x:Key="TrayToggleHoverBackground"
                         GradientOrigin="0.15,0.15"
                         RadiusX="0.75"
                         RadiusY="0.7">
        <GradientStop Color="#c3e5f9"
                      Offset="0.0" />
        <GradientStop Color="#0d98e8"
                      Offset="0.9" />
    </RadialGradientBrush>
    <RadialGradientBrush x:Key="TrayTogglePressedBackground"
                         GradientOrigin="0.1,0.1"
                         RadiusX="0.6"
                         RadiusY="0.6">
        <GradientStop Color="#86caec"
                      Offset="0.0" />
        <GradientStop Color="#0147be"
                      Offset="0.9" />
    </RadialGradientBrush>
    <DropShadowEffect x:Key="TrayToggleArrowOuterShadow"
                      Color="Transparent"
                      Opacity="0"
                      BlurRadius="0"
                      ShadowDepth="0" />
    <DropShadowEffect x:Key="TrayToggleArrowShadow"
                      Color="#077eed"
                      BlurRadius="4"
                      ShadowDepth="0" />
    <SolidColorBrush x:Key="TrayToggleArrowPressed" Color="#6dcaf8" />
    <Thickness x:Key="TrayToggleArrowPadding" Left="5" Top="4" Right="6" Bottom="4" />

    <SolidColorBrush x:Key="TaskButtonTopBorder" Color="#3172da" />
    <SolidColorBrush x:Key="TaskButtonLeftBorder" Color="#3067dd" />
    <SolidColorBrush x:Key="TaskButtonRightBorder" Color="#264fad" />
    <SolidColorBrush x:Key="TaskButtonBottomBorder" Color="#2652bc" />
    <SolidColorBrush x:Key="TaskButtonInnerLeftBorder" Color="#5d98f5" />
    <SolidColorBrush x:Key="TaskButtonInnerRightBorder" Color="#316fe8" />
    <SolidColorBrush x:Key="TaskButtonInnerBottomBorder" Color="#316fe8" />
    <LinearGradientBrush x:Key="TaskButtonBackground"
                         StartPoint="0,0"
                         EndPoint="0,1">
        <GradientStop Color="#4892f7"
                      Offset="0.0" />
        <GradientStop Color="#3980f4"
                      Offset="0.17" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskButtonBackgroundHighlight"
                         StartPoint="0,0"
                         EndPoint="0.03,1">
        <GradientStop Color="#70aafa"
                      Offset="0.0" />
        <GradientStop Color="#003980f4"
                      Offset="0.3" />
    </LinearGradientBrush>

    <SolidColorBrush x:Key="TaskButtonTopBorderHover" Color="#2c5fb2" />
    <SolidColorBrush x:Key="TaskButtonLeftBorderHover" Color="#214ba9" />
    <SolidColorBrush x:Key="TaskButtonRightBorderHover" Color="#1f408c" />
    <SolidColorBrush x:Key="TaskButtonBottomBorderHover" Color="#1d4196" />
    <SolidColorBrush x:Key="TaskButtonInnerLeftBorderHover" Color="#8bc0ff" />
    <SolidColorBrush x:Key="TaskButtonInnerRightBorderHover" Color="#2d86ff" />
    <SolidColorBrush x:Key="TaskButtonInnerBottomBorderHover" Color="#2d86ff" />
    <LinearGradientBrush x:Key="TaskButtonBackgroundHover"
                         StartPoint="0,0"
                         EndPoint="0,1">
        <GradientStop Color="#8bc0ff"
                      Offset="0.0" />
        <GradientStop Color="#59a4ff"
                      Offset="0.05" />
        <GradientStop Color="#569fff"
                      Offset="0.9" />
        <GradientStop Color="#2a81ff"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskButtonBackgroundHighlightHover"
                         StartPoint="0,0"
                         EndPoint="0.03,1">
        <GradientStop Color="#8bc0ff"
                      Offset="0.0" />
        <GradientStop Color="#0059a4ff"
                      Offset="0.3" />
    </LinearGradientBrush>

    <SolidColorBrush x:Key="TaskButtonTopBorderPressed" Color="#1c62d2" />
    <SolidColorBrush x:Key="TaskButtonLeftBorderPressed" Color="#082970" />
    <SolidColorBrush x:Key="TaskButtonRightBorderPressed" Color="#0e3c9f" />
    <SolidColorBrush x:Key="TaskButtonBottomBorderPressed" Color="#0c3cae" />
    <SolidColorBrush x:Key="TaskButtonInnerLeftBorderPressed" Color="#143e95" />
    <SolidColorBrush x:Key="TaskButtonInnerRightBorderPressed" Color="#07ffffff" />
    <SolidColorBrush x:Key="TaskButtonInnerBottomBorderPressed" Color="#07ffffff" />
    <LinearGradientBrush x:Key="TaskButtonBackgroundPressed"
                         StartPoint="0,0"
                         EndPoint="0,1">
        <GradientStop Color="#123d94"
                      Offset="0.0" />
        <GradientStop Color="#1951b9"
                      Offset="0.05" />
        <GradientStop Color="#1a50b8"
                      Offset="0.8" />
        <GradientStop Color="#2156b7"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskButtonBackgroundHighlightPressed"
                         StartPoint="0,0"
                         EndPoint="0.03,1">
        <GradientStop Color="Transparent"
                      Offset="0.0" />
        <GradientStop Color="Transparent"
                      Offset="0.3" />
    </LinearGradientBrush>

    <SolidColorBrush x:Key="TaskButtonTopBorderPressedHover" Color="#2266d5" />
    <SolidColorBrush x:Key="TaskButtonInnerLeftBorderPressedHover" Color="#1c51c2" />
    <SolidColorBrush x:Key="TaskButtonInnerRightBorderPressedHover" Color="#2266d5" />
    <SolidColorBrush x:Key="TaskButtonInnerBottomBorderPressedHover" Color="#2266d5" />
    <LinearGradientBrush x:Key="TaskButtonBackgroundPressedHover"
                         StartPoint="0,0"
                         EndPoint="0,1">
        <GradientStop Color="#1a51c2"
                      Offset="0.0" />
        <GradientStop Color="#326fea"
                      Offset="0.05" />
        <GradientStop Color="#326ee9"
                      Offset="0.9" />
        <GradientStop Color="#2c6de5"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskButtonBackgroundHighlightPressedHover"
                         StartPoint="0,0"
                         EndPoint="0.03,1">
        <GradientStop Color="Transparent"
                      Offset="0.0" />
        <GradientStop Color="Transparent"
                      Offset="0.3" />
    </LinearGradientBrush>

    <SolidColorBrush x:Key="TaskButtonTopBorderFlashing" Color="#d37400" />
    <SolidColorBrush x:Key="TaskButtonLeftBorderFlashing" Color="#d37400" />
    <SolidColorBrush x:Key="TaskButtonRightBorderFlashing" Color="#a35700" />
    <SolidColorBrush x:Key="TaskButtonBottomBorderFlashing" Color="#a35500" />
    <SolidColorBrush x:Key="TaskButtonInnerLeftBorderFlashing" Color="#ffa12b" />
    <SolidColorBrush x:Key="TaskButtonBottomRightBorderFlashing" Color="Transparent" />
    <LinearGradientBrush x:Key="TaskButtonBackgroundFlashing"
                         StartPoint="0,0"
                         EndPoint="0,1">
        <GradientStop Color="#ffb843"
                      Offset="0.0" />
        <GradientStop Color="#e37a08"
                      Offset="0.17" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskButtonBackgroundHighlightFlashing"
                         StartPoint="0,0"
                         EndPoint="0.03,1">
        <GradientStop Color="#ffc96d"
                      Offset="0.0" />
        <GradientStop Color="#00e37a08"
                      Offset="0.3" />
    </LinearGradientBrush>

    <CornerRadius x:Key="TaskListScrollUpCornerRadius">0,0,2,2</CornerRadius>
    <CornerRadius x:Key="TaskListScrollDownCornerRadius">2,2,0,0</CornerRadius>
    <CornerRadius x:Key="TaskListScrollLeftCornerRadius">0,2,2,0</CornerRadius>
    <CornerRadius x:Key="TaskListScrollRightCornerRadius">2,0,0,2</CornerRadius>

    <SolidColorBrush x:Key="TaskListScrollButtonTopBorder" Color="#26000000" />
    <SolidColorBrush x:Key="TaskListScrollButtonLeftBorder" Color="#26ffffff" />
    <SolidColorBrush x:Key="TaskListScrollButtonRightBorder" Color="#26ffffff" />
    <SolidColorBrush x:Key="TaskListScrollButtonBottomBorder" Color="#26ffffff" />
    <SolidColorBrush x:Key="TaskListScrollButtonInnerTopBorder" Color="Transparent" />
    <SolidColorBrush x:Key="TaskListScrollButtonInnerLeftBorder" Color="#33000000" />
    <SolidColorBrush x:Key="TaskListScrollButtonInnerRightBorder" Color="#33000000" />
    <SolidColorBrush x:Key="TaskListScrollButtonInnerBottomBorder" Color="#33000000" />
    <SolidColorBrush x:Key="TaskListScrollButtonOuterLeftBorder" Color="#1f000000" />
    <SolidColorBrush x:Key="TaskListScrollButtonOuterRightBorder" Color="#55000000" />
    <SolidColorBrush x:Key="TaskListScrollButtonOuterBottomBorder" Color="#44000000" />
    <LinearGradientBrush x:Key="TaskListScrollButtonBackground"
                         StartPoint="0,0"
                         EndPoint="1,1">
        <GradientStop Color="#26000000"
                      Offset="0.0" />
        <GradientStop Color="#33000000"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskListScrollButtonBackgroundHover"
                         StartPoint="0,0"
                         EndPoint="1,1">
        <GradientStop Color="#5576FC"
                      Offset="0.0" />
        <GradientStop Color="#4A58E7"
                      Offset="1.0" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="TaskListScrollButtonBackgroundPressed"
                         StartPoint="0,0"
                         EndPoint="1,1">
        <GradientStop Color="#272784"
                      Offset="0.0" />
        <GradientStop Color="#363CCA"
                      Offset="1.0" />
    </LinearGradientBrush>
    <SolidColorBrush x:Key="TaskListScrollDownButtonInnerTopBorder" Color="#33000000" />
    <SolidColorBrush x:Key="TaskListScrollDownButtonOuterTopBorder" Color="#44000000" />
    <SolidColorBrush x:Key="TaskListScrollDownButtonTopBorder" Color="#26ffffff" />
    <SolidColorBrush x:Key="TaskListScrollDownButtonInnerBottomBorder" Color="Transparent" />
    <SolidColorBrush x:Key="TaskListScrollDownButtonBottomBorder" Color="Transparent" />
    <SolidColorBrush x:Key="TaskListScrollArrow" Color="#bedcff" />

    <SolidColorBrush x:Key="ToolbarThumbForeground" Color="#082ea0" />
    <SolidColorBrush x:Key="ToolbarThumbBackground" Color="#128de6" />

    <DropShadowEffect x:Key="StartLabelShadow"
                      Color="#454c10"
                      Direction="315"
                      ShadowDepth="1"
                      BlurRadius="4"
                      Opacity="1" />

    <SolidColorBrush x:Key="ItemButtonForeground" Color="#ffffff" />
    <SolidColorBrush x:Key="ButtonForeground" Color="#ffffff" />
    <SolidColorBrush x:Key="ButtonActiveForeground" Color="#ffffff" />
    <SolidColorBrush x:Key="ButtonPressedForeground" Color="#ffffff" />
    <SolidColorBrush x:Key="ClockForeground" Color="#ffffff" />
    <SolidColorBrush x:Key="InputLanguageForeground" Color="#ffffff" />
    <SolidColorBrush x:Key="InputLanguageBackground" Color="#316ac5" />

    <SolidColorBrush x:Key="ToolTipBackground" Color="#FFFFE1" />
    <SolidColorBrush x:Key="ToolTipForeground" Color="#000000" />

    <SolidColorBrush x:Key="BalloonCloseButtonInactiveBackground" Color="#FFFFF5" />
    <SolidColorBrush x:Key="BalloonCloseButtonInactiveBorder" Color="#C7BEA6" />
    <SolidColorBrush x:Key="BalloonCloseButtonInactiveForeground" Color="#AA9C87" />
    <SolidColorBrush x:Key="BalloonCloseButtonInactiveShadow" Color="Transparent" />

    <SolidColorBrush x:Key="BalloonCloseButtonActiveBorder" Color="#FFFFFF" />
    <SolidColorBrush x:Key="BalloonCloseButtonActiveForeground" Color="#FFFFFF" />
    <SolidColorBrush x:Key="BalloonCloseButtonActiveShadowLight" Color="#F3F3D6" />
    <SolidColorBrush x:Key="BalloonCloseButtonActiveShadowDark" Color="#B8B8A2" />

    <SolidColorBrush x:Key="BalloonCloseButtonHoverInnerLight" Color="#11000000" />
    <SolidColorBrush x:Key="BalloonCloseButtonHoverInnerDark" Color="#33000000" />

    <RadialGradientBrush x:Key="BalloonCloseButtonHoverBackground"
                         GradientOrigin="1.0,1.0"
                         RadiusX="0.8"
                         RadiusY="0.8">
        <GradientStop Color="#ffde17"
                      Offset="0.0" />
        <GradientStop Color="#ffad31"
                      Offset="0.5" />
        <GradientStop Color="#ffad31"
                      Offset="0.6" />
        <GradientStop Color="#ffd9a1"
                      Offset="1.0" />
    </RadialGradientBrush>

    <SolidColorBrush x:Key="BalloonCloseButtonPressedInnerLight" Color="#08000000" />
    <SolidColorBrush x:Key="BalloonCloseButtonPressedInnerDark" Color="#33000000" />

    <RadialGradientBrush x:Key="BalloonCloseButtonPressedBackground"
                         GradientOrigin="1.0,1.0"
                         RadiusX="0.8"
                         RadiusY="0.8">
        <GradientStop Color="#d89500"
                      Offset="0.0" />
        <GradientStop Color="#cc7900"
                      Offset="0.5" />
        <GradientStop Color="#cc7900"
                      Offset="0.6" />
        <GradientStop Color="#a96000"
                      Offset="1.0" />
    </RadialGradientBrush>

    <BitmapImage x:Key="StartIconImage"
                 UriSource="../Resources/startxpblue.png" />
    <BitmapImage x:Key="StartButtonImage"
                 UriSource="../Resources/startxpbluebutton.png" />
    <BitmapImage x:Key="ShowDesktopIconImageSmall"
                 UriSource="../Resources/desktopxp-sm.png" />
    <BitmapImage x:Key="ShowDesktopIconImageLarge"
                 UriSource="../Resources/desktopxp-lg.png" />

    <Style TargetType="MenuItem"
           x:Key="TaskManMenuItem"
           BasedOn="{StaticResource {x:Type MenuItem}}">
        <Setter Property="Header"
                Value="{DynamicResource show_taskman}" />
    </Style>

    <FontFamily x:Key="GlobalFontFamily">Tahoma</FontFamily>

    <Style TargetType="ContentControl"
           x:Key="Taskbar"
           BasedOn="{StaticResource Taskbar}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ContentControl">
                    <Border BorderThickness="0"
                            BorderBrush="{DynamicResource TaskbarUnlockedBorderTop}"
                            x:Name="TaskbarUnlockedBorderTop">
                        <Border BorderThickness="0"
                                BorderBrush="{DynamicResource TaskbarUnlockedBottomBorder}"
                                x:Name="TaskbarUnlockedBorder">
                            <Border BorderThickness="0,1,0,0"
                                    BorderBrush="{DynamicResource TaskbarBorder}"
                                    Background="{DynamicResource TaskbarBackgroundTall}"
                                    x:Name="TaskbarBorder">
                                <ContentPresenter Margin="0,-1,0,0"
                                                  Name="Content" />
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="TaskbarBorder"
                                        Property="Background"
                                        Value="{DynamicResource TaskbarVerticalBackground}" />
                                <Setter TargetName="TaskbarBorder"
                                        Property="BorderThickness"
                                        Value="0" />
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="0" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                           Value="Horizontal"/>
                                <Condition Binding="{Binding Path=Rows, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                           Value="1"/>
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarBorder"
                                        Property="Background"
                                        Value="{DynamicResource TaskbarBackground}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=AppBarMode, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="AutoHide" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Bottom" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="0,3,0,0" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=AppBarMode, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="AutoHide" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Top" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,3" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedTopBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=AppBarMode, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="AutoHide" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Right" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="3,0,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedRightBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=AppBarMode, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="AutoHide" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Right" />
                                <Condition Binding="{Binding Path=FlowDirection, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="RightToLeft" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="0,0,3,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedLeftBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=AppBarMode, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="AutoHide" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Left" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="0,0,3,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedLeftBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=AppBarMode, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="AutoHide" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Left" />
                                <Condition Binding="{Binding Path=FlowDirection, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="RightToLeft" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="3,0,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedRightBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsLocked, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="False" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Bottom" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="0,3,0,0" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsLocked, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="False" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Top" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,3" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedTopBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsLocked, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="False" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Right" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="3,0,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedRightBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsLocked, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="False" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Right" />
                                <Condition Binding="{Binding Path=FlowDirection, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="RightToLeft" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="0,0,3,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedLeftBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsLocked, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="False" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Left" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="0,0,3,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedLeftBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsLocked, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="False" />
                                <Condition Binding="{Binding Path=AppBarEdge, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Left" />
                                <Condition Binding="{Binding Path=FlowDirection, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="RightToLeft" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="TaskbarUnlockedBorderTop"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderThickness"
                                        Value="3,0,0,0" />
                                <Setter TargetName="TaskbarUnlockedBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource TaskbarUnlockedRightBorder}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate TargetType="MenuItem"
                     x:Key="{ComponentResourceKey TypeInTargetAssembly={x:Type MenuItem}, ResourceId=SubmenuItemTemplateKey}">
        <Border Name="Border"
                Background="{TemplateBinding Background}"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="{TemplateBinding BorderThickness}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MinWidth="17"
                                      Width="Auto"
                                      SharedSizeGroup="MenuItemIconColumnGroup" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto"
                                      SharedSizeGroup="MenuItemIGTColumnGroup" />
                    <ColumnDefinition Width="14"/>
                </Grid.ColumnDefinitions>
                <ContentPresenter x:Name="Icon"
                                  Margin="4,0,6,0"
                                  VerticalAlignment="Center"
                                  ContentSource="Icon"
                                  TextBlock.FontSize="13"
                                  TextBlock.FontStyle="{DynamicResource {x:Static SystemFonts.MenuFontStyleKey}}"
                                  TextBlock.FontWeight="{DynamicResource {x:Static SystemFonts.MenuFontWeightKey}}" />
                <Path x:Name="GlyphPanel"
                      Margin="4,0,6,0"
                      Visibility="Hidden"
                      VerticalAlignment="Center"
                      Fill="{TemplateBinding Foreground}"
                      FlowDirection="LeftToRight"
                      Data="{DynamicResource Checkmark}"/>
                <ContentPresenter Grid.Column="1"
                                  ContentSource="Header"
                                  Margin="{TemplateBinding Padding}"
                                  RecognizesAccessKey="True"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                <TextBlock x:Name="InputGestureText"
                           Grid.Column="2"
                           Text="{TemplateBinding InputGestureText}"
                           Margin="5,2,0,2"
                           DockPanel.Dock="Right" />
            </Grid>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="Icon"
                     Value="{x:Null}">
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed" />
            </Trigger>
            <Trigger Property="IsChecked"
                     Value="True">
                <Setter TargetName="GlyphPanel"
                        Property="Visibility"
                        Value="Visible" />
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed" />
            </Trigger>
            <Trigger Property="IsHighlighted"
                     Value="True">
                <Setter TargetName="Border"
                        Property="Background"
                        Value="{DynamicResource HighlightBackground}" />
                <Setter Property="Foreground"
                        Value="{DynamicResource HighlightForeground}" />
            </Trigger>
            <Trigger Property="StaysOpenOnClick"
                     Value="True">
                <Setter Property="Foreground"
                        Value="{DynamicResource MenuDisabledForeground}" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <Style TargetType="ContextMenu"
           x:Key="{x:Type ContextMenu}"
           BasedOn="{StaticResource {x:Type ContextMenu}}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ContextMenu}">
                    <Border Name="ContextMenuBorder" Background="{TemplateBinding Background}"
                            BorderBrush="{DynamicResource MenuDisabledForeground}"
                            BorderThickness="1">
                            <ScrollViewer Name="ContextMenuScrollViewer"
                                          Style="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type FrameworkElement}, ResourceId=MenuScrollViewer}}">
                                <Grid RenderOptions.ClearTypeHint="Enabled">
                                    <Canvas Height="0" Width="0" HorizontalAlignment="Left" VerticalAlignment="Top">
                                        <Rectangle Name="OpaqueRect"
                                                   Height="{Binding ElementName=ContextMenuBorder,Path=ActualHeight}"
                                                   Width="{Binding ElementName=ContextMenuBorder,Path=ActualWidth}"
                                                   Fill="{Binding ElementName=ContextMenuBorder,Path=Background}" />
                                    </Canvas>
                                    <ItemsPresenter Name="ItemsPresenter" Margin="2"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    SnapsToDevicePixels="True" />
                                </Grid>
                            </ScrollViewer>
                        </Border>
                    <ControlTemplate.Triggers>
                        <Trigger SourceName="ContextMenuScrollViewer"
                                 Property="ScrollViewer.CanContentScroll"
                                 Value="False">
                            <Setter TargetName="OpaqueRect"
                                    Property="Canvas.Top"
                                    Value="{Binding ElementName=ContextMenuScrollViewer, Path=VerticalOffset}" />
                            <Setter TargetName="OpaqueRect"
                                    Property="Canvas.Left"
                                    Value="{Binding ElementName=ContextMenuScrollViewer, Path=HorizontalOffset}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="GroupBox"
           x:Key="Tray">
        <Setter Property="OverridesDefaultStyle"
                Value="True" />
        <Setter Property="Margin"
                Value="10,0,0,0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="GroupBox">
                    <Border BorderThickness="0,1"
                            BorderBrush="{DynamicResource TrayTopBottomBorder}"
                            Name="TrayOuterBorder">
                        <Border BorderThickness="1,0,0,0"
                                BorderBrush="{DynamicResource TrayLeftBorder1}"
                                Background="{DynamicResource TrayBackground}"
                                Name="TrayInnerBorder1">
                            <Border BorderThickness="1,0,0,0"
                                    BorderBrush="{DynamicResource TrayLeftBorder2}"
                                    Name="TrayInnerBorder2">
                                <Border BorderThickness="1,0,0,0"
                                        BorderBrush="{DynamicResource TrayLeftBorder3}"
                                        Name="TrayInnerBorder3">
                                    <Border BorderThickness="1,0,0,0"
                                            BorderBrush="{DynamicResource TrayLeftBorder4}"
                                            Padding="7,0,0,0"
                                            Name="TrayInnerBorder4">
                                        <ContentPresenter Margin="0,0,6,0"
                                                          Name="Content" />
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="TrayOuterBorder"
                                        Property="BorderThickness"
                                        Value="1,0" />
                                <Setter TargetName="TrayInnerBorder1"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="TrayInnerBorder2"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="TrayInnerBorder3"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="TrayInnerBorder4"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="TrayInnerBorder4"
                                        Property="Padding"
                                        Value="0,7,0,0" />
                                <Setter TargetName="TrayInnerBorder1"
                                        Property="Background"
                                        Value="{DynamicResource TrayVerticalBackground}" />
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="0,0,0,6" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="0,10,0,0" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="Button"
           x:Key="TaskButton"
           BasedOn="{StaticResource TaskButton}">
        <Setter Property="Margin"
                Value="{DynamicResource TaskButtonMargin}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="Transparent"
                            Padding="0,3,0,2"
                            Name="ButtonBorder">
                        <Border BorderThickness="0,1,0,0"
                                BorderBrush="{DynamicResource TaskButtonTopBorder}"
                                Background="Transparent"
                                CornerRadius="2"
                                x:Name="ButtonTopBorder">
                            <Border BorderThickness="1,0,0,0"
                                    BorderBrush="{DynamicResource TaskButtonLeftBorder}"
                                    CornerRadius="2"
                                    x:Name="ButtonLeftBorder">
                                <Border BorderThickness="0,0,0,1"
                                        BorderBrush="{DynamicResource TaskButtonBottomBorder}"
                                        CornerRadius="2"
                                        x:Name="ButtonBottomBorder">
                                    <Border BorderThickness="0,0,1,0"
                                            BorderBrush="{DynamicResource TaskButtonRightBorder}"
                                            CornerRadius="2"
                                            x:Name="ButtonRightBorder">
                                        <Border BorderThickness="0,0,0,1"
                                                BorderBrush="{DynamicResource TaskButtonInnerBottomBorder}"
                                                Background="{DynamicResource TaskButtonBackground}"
                                                CornerRadius="2"
                                                x:Name="ButtonInnerBottomBorder">
                                            <Border BorderThickness="1,0,0,0"
                                                    BorderBrush="{DynamicResource TaskButtonInnerLeftBorder}"
                                                    CornerRadius="2"
                                                    x:Name="ButtonInnerLeftBorder">
                                                <Border BorderThickness="0,0,1,0"
                                                        BorderBrush="{DynamicResource TaskButtonInnerRightBorder}"
                                                        Background="{DynamicResource TaskButtonBackgroundHighlight}"
                                                        CornerRadius="2"
                                                        x:Name="ButtonInnerRightBorder">
                                                    <ContentPresenter Margin="8,3"
                                                                  x:Name="Content" />
                                                </Border>
                                            </Border>
                                        </Border>
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource Self}}"
                                           Value="False" />
                                <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Vertical" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="8,6,8,5" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource Self}}"
                                           Value="True" />
                                <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Vertical" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="9,7,7,4" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="ButtonBorder"
                                        Property="Padding"
                                        Value="1,0,1,0" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonTopBorderHover}" />
                            <Setter TargetName="ButtonLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonLeftBorderHover}" />
                            <Setter TargetName="ButtonRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonRightBorderHover}" />
                            <Setter TargetName="ButtonBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonBottomBorderHover}" />
                            <Setter TargetName="ButtonInnerLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerLeftBorderHover}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerRightBorderHover}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerBottomBorderHover}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundHover}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundHighlightHover}" />
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="True">
                            <Setter Property="Foreground"
                                    Value="{DynamicResource ButtonPressedForeground}" />
                            <Setter TargetName="ButtonTopBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonTopBorderPressed}" />
                            <Setter TargetName="ButtonLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonLeftBorderPressed}" />
                            <Setter TargetName="ButtonRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonRightBorderPressed}" />
                            <Setter TargetName="ButtonBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonBottomBorderPressed}" />
                            <Setter TargetName="ButtonInnerLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerLeftBorderPressed}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerRightBorderPressed}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerBottomBorderPressed}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="Background"
                                    Value="Transparent" />
                            <Setter TargetName="ButtonTopBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundPressed}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundHighlightPressed}" />
                        </Trigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource Self}}"
                                           Value="True" />
                                <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Horizontal" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="9,4,7,2" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="Button"
           x:Key="TaskButtonActive"
           BasedOn="{StaticResource TaskButton}">
        <Setter Property="Foreground"
                Value="{DynamicResource ButtonActiveForeground}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="Transparent"
                            Padding="0,3,0,2"
                            Name="ButtonBorder">
                        <Border BorderThickness="0,1,0,0"
                                BorderBrush="{DynamicResource TaskButtonTopBorderPressed}"
                                Background="{DynamicResource TaskButtonBackgroundPressed}"
                                CornerRadius="2"
                                x:Name="ButtonTopBorder">
                            <Border BorderThickness="1,0,0,0"
                                    BorderBrush="{DynamicResource TaskButtonLeftBorderPressed}"
                                    Background="{DynamicResource TaskButtonBackgroundHighlightPressed}"
                                    CornerRadius="2"
                                    x:Name="ButtonLeftBorder">
                                <Border BorderThickness="0,0,0,1"
                                        BorderBrush="{DynamicResource TaskButtonBottomBorderPressed}"
                                        CornerRadius="2"
                                        x:Name="ButtonBottomBorder">
                                    <Border BorderThickness="0,0,1,0"
                                            BorderBrush="{DynamicResource TaskButtonRightBorderPressed}"
                                            CornerRadius="2"
                                            x:Name="ButtonRightBorder">
                                        <Border BorderThickness="1,0,0,0"
                                                BorderBrush="{DynamicResource TaskButtonInnerLeftBorderPressed}"
                                                CornerRadius="2"
                                                x:Name="ButtonInnerLeftBorder">
                                            <Border BorderThickness="0,0,1,0"
                                                    BorderBrush="{DynamicResource TaskButtonInnerRightBorderPressed}"
                                                    CornerRadius="2"
                                                    x:Name="ButtonInnerRightBorder">
                                                <Border BorderThickness="0,0,0,1"
                                                        BorderBrush="{DynamicResource TaskButtonInnerBottomBorderPressed}"
                                                        CornerRadius="2"
                                                        x:Name="ButtonInnerBottomBorder">
                                                    <ContentPresenter Margin="9,4,7,2"
                                                                  x:Name="Content" />
                                                </Border>
                                            </Border>
                                        </Border>
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="ButtonBorder"
                                        Property="Padding"
                                        Value="1,0,1,0" />
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="8,6,8,5" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonTopBorderPressedHover}" />
                            <Setter TargetName="ButtonInnerLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerLeftBorderPressedHover}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerRightBorderPressedHover}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerBottomBorderPressedHover}" />
                            <Setter TargetName="ButtonTopBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundPressedHover}" />
                            <Setter TargetName="ButtonLeftBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundHighlightPressedHover}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="Button"
           x:Key="TaskButtonFlashing"
           BasedOn="{StaticResource TaskButton}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="Transparent"
                            Padding="0,3,0,2"
                            Name="ButtonBorder">
                        <Border BorderThickness="0,1,0,0"
                                BorderBrush="{DynamicResource TaskButtonTopBorderFlashing}"
                                CornerRadius="2"
                                x:Name="ButtonTopBorder">
                            <Border BorderThickness="1,0,0,0"
                                    BorderBrush="{DynamicResource TaskButtonLeftBorderFlashing}"
                                    CornerRadius="2"
                                    x:Name="ButtonLeftBorder">
                                <Border BorderThickness="0,0,0,1"
                                        BorderBrush="{DynamicResource TaskButtonBottomBorderFlashing}"
                                        CornerRadius="2"
                                        x:Name="ButtonBottomBorder">
                                    <Border BorderThickness="0,0,1,0"
                                            BorderBrush="{DynamicResource TaskButtonRightBorderFlashing}"
                                            CornerRadius="2"
                                            x:Name="ButtonRightBorder">
                                        <Border BorderThickness="1,0,0,0"
                                                BorderBrush="{DynamicResource TaskButtonInnerLeftBorderFlashing}"
                                                Background="{DynamicResource TaskButtonBackgroundFlashing}"
                                                CornerRadius="2"
                                                x:Name="ButtonInnerLeftBorder">
                                            <Border BorderThickness="0,0,1,1"
                                                    BorderBrush="{DynamicResource TaskButtonBottomRightBorderFlashing}"
                                                    Background="{DynamicResource TaskButtonBackgroundHighlightFlashing}"
                                                    CornerRadius="2"
                                                    x:Name="ButtonBottomRightBorder">
                                                <ContentPresenter Margin="8,3"
                                                                  x:Name="Content" />
                                            </Border>
                                        </Border>
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource Self}}"
                                           Value="False" />
                                <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Vertical" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="8,6,8,5" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource Self}}"
                                           Value="True" />
                                <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Vertical" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="9,7,7,4" />
                                <Setter Property="Foreground"
                                        Value="{DynamicResource ButtonPressedForeground}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="ButtonBorder"
                                        Property="Padding"
                                        Value="1,0,1,0" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource Self}}"
                                           Value="True" />
                                <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                           Value="Horizontal" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="9,4,7,2" />
                                <Setter Property="Foreground"
                                        Value="{DynamicResource ButtonPressedForeground}" />
                            </MultiDataTrigger.Setters>
                        </MultiDataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="ContentControl"
           x:Key="TaskButtonThumbnail">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ContentControl">
                    <Border BorderThickness="1"
                            CornerRadius="4"
                            BorderBrush="{DynamicResource ToolTipForeground}"
                            Background="{DynamicResource ToolTipBackground}"
                            Padding="4"
                            Margin="4">
                        <ContentPresenter />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="TaskListScrollUpButton"
           TargetType="RepeatButton"
           BasedOn="{StaticResource TaskListScrollButton}">
        <Setter Property="Margin"
                Value="0,1,0,0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="RepeatButton">
                    <Border BorderThickness="1,0,0,0"
                            BorderBrush="{DynamicResource TaskListScrollButtonOuterLeftBorder}"
                            CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                            x:Name="ButtonOuterLeftBorder">
                        <Border BorderThickness="0,0,1,0"
                                BorderBrush="{DynamicResource TaskListScrollButtonOuterRightBorder}"
                                CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                x:Name="ButtonOuterRightBorder">
                            <Border BorderThickness="0,0,0,1"
                                    BorderBrush="{DynamicResource TaskListScrollButtonOuterBottomBorder}"
                                    CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                    x:Name="ButtonOuterBottomBorder">
                                <Border BorderThickness="0,0,0,1"
                                        BorderBrush="{DynamicResource TaskListScrollButtonBottomBorder}"
                                        CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                        x:Name="ButtonBottomBorder">
                                    <Border BorderThickness="1,0,0,0"
                                            BorderBrush="{DynamicResource TaskListScrollButtonLeftBorder}"
                                            CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                            x:Name="ButtonLeftBorder">
                                        <Border BorderThickness="0,0,1,0"
                                                BorderBrush="{DynamicResource TaskListScrollButtonRightBorder}"
                                                CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                                x:Name="ButtonRightBorder">
                                            <Border BorderThickness="0,1,0,0"
                                                    BorderBrush="{DynamicResource TaskListScrollButtonTopBorder}"
                                                    Background="{DynamicResource TaskListScrollButtonBackground}"
                                                    CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                                    x:Name="ButtonTopBorder">
                                                <Border BorderThickness="0,0,0,1"
                                                        BorderBrush="{DynamicResource TaskListScrollButtonInnerBottomBorder}"
                                                        CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                                        x:Name="ButtonInnerBottomBorder">
                                                    <Border BorderThickness="1,0,0,0"
                                                            BorderBrush="{DynamicResource TaskListScrollButtonInnerLeftBorder}"
                                                            CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                                            x:Name="ButtonInnerLeftBorder">
                                                        <Border BorderThickness="0,0,1,0"
                                                                BorderBrush="{DynamicResource TaskListScrollButtonInnerRightBorder}"
                                                                CornerRadius="{DynamicResource TaskListScrollUpCornerRadius}"
                                                                x:Name="ButtonInnerRightBorder">
                                                            <ContentPresenter HorizontalAlignment="Center"
                                                                              VerticalAlignment="Center"
                                                                              Margin="1,-3,1,-3"
                                                                              x:Name="Content" />
                                                        </Border>
                                                    </Border>
                                                </Border>
                                            </Border>
                                        </Border>
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskListScrollButtonBackgroundHover}" />
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskListScrollButtonBackgroundPressed}" />
                        </Trigger>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="ButtonLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="ButtonTopBorder"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="ButtonRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonBottomBorder"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="ButtonInnerLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="ButtonInnerRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonInnerBottomBorder"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="ButtonOuterLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="ButtonOuterRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonOuterBottomBorder"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="ButtonLeftBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonTopBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonRightBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonBottomBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonInnerLeftBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonInnerRightBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonInnerBottomBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonOuterLeftBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonOuterRightBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                                <Setter TargetName="ButtonOuterBottomBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollLeftCornerRadius}" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="0" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="TaskListScrollDownButton"
           TargetType="RepeatButton"
           BasedOn="{StaticResource TaskListScrollButton}">
        <Setter Property="Margin"
                Value="0,-1,0,0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="RepeatButton">
                    <Border BorderThickness="1,0,0,0"
                            BorderBrush="{DynamicResource TaskListScrollButtonOuterLeftBorder}"
                            CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                            x:Name="ButtonOuterLeftBorder">
                        <Border BorderThickness="0,0,1,0"
                                BorderBrush="{DynamicResource TaskListScrollButtonOuterRightBorder}"
                                CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                x:Name="ButtonOuterRightBorder">
                            <Border BorderThickness="0,1,0,0"
                                    BorderBrush="{DynamicResource TaskListScrollDownButtonOuterTopBorder}"
                                    CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                    x:Name="ButtonOuterTopBorder">
                                <Border BorderThickness="0,0,0,1"
                                        BorderBrush="{DynamicResource TaskListScrollDownButtonBottomBorder}"
                                        CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                        x:Name="ButtonBottomBorder">
                                    <Border BorderThickness="1,0,0,0"
                                            BorderBrush="{DynamicResource TaskListScrollButtonLeftBorder}"
                                            CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                            x:Name="ButtonLeftBorder">
                                        <Border BorderThickness="0,0,1,0"
                                                BorderBrush="{DynamicResource TaskListScrollButtonRightBorder}"
                                                CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                                x:Name="ButtonRightBorder">
                                            <Border BorderThickness="0,1,0,0"
                                                    BorderBrush="{DynamicResource TaskListScrollDownButtonTopBorder}"
                                                    CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                                    x:Name="ButtonTopBorder">
                                                <Border BorderThickness="0,0,0,1"
                                                        BorderBrush="{DynamicResource TaskListScrollDownButtonInnerBottomBorder}"
                                                        Background="{DynamicResource TaskListScrollButtonBackground}"
                                                        CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                                        x:Name="ButtonInnerBottomBorder">
                                                    <Border BorderThickness="1,0,0,0"
                                                            BorderBrush="{DynamicResource TaskListScrollButtonInnerLeftBorder}"
                                                            CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                                            x:Name="ButtonInnerLeftBorder">
                                                        <Border BorderThickness="0,0,1,0"
                                                                BorderBrush="{DynamicResource TaskListScrollButtonInnerRightBorder}"
                                                                CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                                                x:Name="ButtonInnerRightBorder">
                                                            <Border BorderThickness="0,1,0,0"
                                                                    BorderBrush="{DynamicResource TaskListScrollDownButtonInnerTopBorder}"
                                                                    CornerRadius="{DynamicResource TaskListScrollDownCornerRadius}"
                                                                    x:Name="ButtonInnerTopBorder">
                                                                <ContentPresenter HorizontalAlignment="Center"
                                                                              VerticalAlignment="Center"
                                                                              Margin="1,-4,1,-3"
                                                                              x:Name="Content" />
                                                            </Border>
                                                        </Border>
                                                    </Border>
                                                </Border>
                                            </Border>
                                        </Border>
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskListScrollButtonBackgroundHover}" />
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="True">
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskListScrollButtonBackgroundPressed}" />
                        </Trigger>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="1,-3,1,-3" />
                                <Setter TargetName="ButtonLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="ButtonTopBorder"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="ButtonRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonBottomBorder"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="ButtonInnerLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="ButtonInnerRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonInnerBottomBorder"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="ButtonInnerTopBorder"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="ButtonOuterLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="ButtonOuterRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonOuterTopBorder"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="ButtonLeftBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonTopBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonRightBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonBottomBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonInnerLeftBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonInnerRightBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonInnerBottomBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonInnerTopBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonOuterLeftBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonOuterRightBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                                <Setter TargetName="ButtonOuterTopBorder"
                                        Property="CornerRadius"
                                        Value="{DynamicResource TaskListScrollRightCornerRadius}" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="0" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <ToolTip x:Key="StartButtonTip" Content="{DynamicResource start_button_tip}" />

    <Style TargetType="ToggleButton"
           x:Key="StartButton">
        <Setter Property="OverridesDefaultStyle"
                Value="True" />
        <Setter Property="Foreground"
                Value="{DynamicResource ItemButtonForeground}" />
        <Setter Property="Margin"
                Value="0,0,1,-3" />
        <Setter Property="MinWidth"
                Value="99" />
        <Setter Property="Height"
                Value="32" />
        <Setter Property="FocusVisualStyle"
                Value="{x:Null}" />
        <Setter Property="VerticalAlignment"
                Value="Top" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ToggleButton">
                    <Border x:Name="StartButtonBorder" HorizontalAlignment="Left">
                        <Border.Background>
                            <ImageBrush ImageSource="{DynamicResource StartButtonImage}"
                                        ViewboxUnits="RelativeToBoundingBox"
                                        Viewbox="0,0,1,0.3333" />
                        </Border.Background>
                        <ContentPresenter Margin="0,-3,0,0" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="StartButtonBorder"
                                    Property="Background">
                                <Setter.Value>
                                    <ImageBrush ImageSource="{DynamicResource StartButtonImage}"
                                                ViewboxUnits="RelativeToBoundingBox"
                                                Viewbox="0,0.3333,1,0.3333" />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <Trigger Property="IsChecked"
                                 Value="True">
                            <Setter TargetName="StartButtonBorder"
                                    Property="Background">
                                <Setter.Value>
                                    <ImageBrush ImageSource="{DynamicResource StartButtonImage}"
                                                ViewboxUnits="RelativeToBoundingBox"
                                                Viewbox="0,0.6666,1,0.3333" />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="True">
                            <Setter TargetName="StartButtonBorder"
                                    Property="Background">
                                <Setter.Value>
                                    <ImageBrush ImageSource="{DynamicResource StartButtonImage}"
                                                ViewboxUnits="RelativeToBoundingBox"
                                                Viewbox="0,0.6666,1,0.3333" />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="0" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="Image"
           x:Key="TaskIcon"
           BasedOn="{StaticResource TaskIcon}">
        <Setter Property="Margin"
                Value="0,0,4,0" />
    </Style>

    <Style TargetType="Image"
           x:Key="TaskOverlayIcon"
           BasedOn="{StaticResource TaskOverlayIcon}">
        <Setter Property="Margin"
                Value="0,0,3,-1" />
    </Style>

    <Style TargetType="Image"
           x:Key="StartIcon"
           BasedOn="{StaticResource StartIcon}">
        <Setter Property="Margin"
                Value="10,0,0,0" />
        <Setter Property="Width"
                Value="25" />
        <Setter Property="Height"
                Value="20" />
    </Style>

    <Style TargetType="TextBlock"
           x:Key="StartLabel"
           BasedOn="{StaticResource StartLabel}">
        <Setter Property="Text"
                Value="{DynamicResource start_text_xp}" />
        <Setter Property="FontFamily"
                Value="{DynamicResource start_text_xp_font_family}" />
        <Setter Property="FontSize"
                Value="19" />
        <Setter Property="FontStyle"
                Value="Italic" />
        <Setter Property="FontWeight"
                Value="Normal" />
        <Setter Property="Margin"
                Value="0,0,26,0" />
        <Setter Property="Effect"
                Value="{DynamicResource StartLabelShadow}" />
        <Setter Property="TextOptions.TextRenderingMode"
                Value="Grayscale" />
    </Style>

    <Style TargetType="TextBlock"
           x:Key="Clock"
           BasedOn="{StaticResource Clock}">
        <Setter Property="Margin"
                Value="8,1,11,6" />
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="0,1,0,6" />
                </DataTrigger.Setters>
            </DataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                               Value="Horizontal"/>
                    <Condition Binding="{Binding Path=Rows, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                               Value="1"/>
                </MultiDataTrigger.Conditions>
                <MultiDataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="8,-1,11,0" />
                </MultiDataTrigger.Setters>
            </MultiDataTrigger>
        </Style.Triggers>
    </Style>

    <ControlTemplate TargetType="{x:Type UserControl}"
                     x:Key="ClockTemplateKey">
        <StackPanel Orientation="Vertical">
            <TextBlock Text="{Binding Path=Now, StringFormat=t, Mode=OneWay}"
                       Style="{DynamicResource Clock}"
                       Name="ClockText">
            </TextBlock>
            <TextBlock Text="{Binding Path=Now, StringFormat=dddd, Mode=OneWay}"
                       Style="{DynamicResource Clock}"
                       Margin="8,0,11,6"
                       Name="ClockVerticalDayOfWeek"
                       Visibility="Visible">
            </TextBlock>
            <TextBlock Text="{Binding Path=Now, StringFormat=d, Mode=OneWay}"
                       Style="{DynamicResource Clock}"
                       Margin="8,0,11,3"
                       Name="ClockVerticalDate"
                       Visibility="Visible">
            </TextBlock>
        </StackPanel>
        <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter TargetName="ClockVerticalDayOfWeek"
                            Property="Margin"
                            Value="0,0,0,6" />
                    <Setter TargetName="ClockVerticalDate"
                            Property="Margin"
                            Value="0,0,0,3" />
                </DataTrigger.Setters>
            </DataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Horizontal"/>
                    <Condition Binding="{Binding Path=Rows, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                               Value="1"/>
                </MultiDataTrigger.Conditions>
                <MultiDataTrigger.Setters>
                    <Setter TargetName="ClockVerticalDayOfWeek"
                            Property="Visibility"
                            Value="Collapsed" />
                    <Setter TargetName="ClockVerticalDate"
                            Property="Visibility"
                            Value="Collapsed" />
                </MultiDataTrigger.Setters>
            </MultiDataTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <Style TargetType="Image"
           x:Key="NotifyIcon"
           BasedOn="{StaticResource NotifyIcon}">
        <Setter Property="Margin"
                Value="0,1,2,1" />
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="1,2,1,2" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="ItemsControl"
           x:Key="NotifyIconItems"
           BasedOn="{StaticResource NotifyIconItems}">
        <Setter Property="Margin"
                Value="0,-1" />
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="0" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="ItemsControl"
           x:Key="ToolbarItems"
           BasedOn="{StaticResource ToolbarItems}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="0,3,0,1" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="Button"
           x:Key="ToolbarButton"
           BasedOn="{StaticResource ToolbarButton}">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="Transparent">
                        <Border BorderThickness="0,1,0,0"
                                BorderBrush="Transparent"
                                Background="Transparent"
                                CornerRadius="2"
                                Margin="0,3,0,2"
                                x:Name="ButtonTopBorder">
                            <Border BorderThickness="1,0,0,0"
                                    BorderBrush="Transparent"
                                    CornerRadius="2"
                                    x:Name="ButtonLeftBorder">
                                <Border BorderThickness="0,0,0,1"
                                        BorderBrush="Transparent"
                                        CornerRadius="2"
                                        x:Name="ButtonBottomBorder">
                                    <Border BorderThickness="0,0,1,0"
                                            BorderBrush="Transparent"
                                            CornerRadius="2"
                                            x:Name="ButtonRightBorder">
                                        <Border BorderThickness="0,0,0,1"
                                                BorderBrush="Transparent"
                                                Background="Transparent"
                                                CornerRadius="2"
                                                x:Name="ButtonInnerBottomBorder">
                                            <Border BorderThickness="1,0,0,0"
                                                    BorderBrush="Transparent"
                                                    Background="Transparent"
                                                    CornerRadius="2"
                                                    x:Name="ButtonInnerLeftBorder">
                                                <Border BorderThickness="0,0,1,0"
                                                        BorderBrush="Transparent"
                                                        Background="Transparent"
                                                        CornerRadius="2"
                                                        x:Name="ButtonInnerRightBorder">
                                                    <ContentPresenter Margin="1,3"
                                                                  x:Name="Content" />
                                                </Border>
                                            </Border>
                                        </Border>
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="ButtonTopBorder"
                                        Property="Margin"
                                        Value="0" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonTopBorder}" />
                            <Setter TargetName="ButtonLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonLeftBorder}" />
                            <Setter TargetName="ButtonRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonRightBorder}" />
                            <Setter TargetName="ButtonBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonBottomBorder}" />
                            <Setter TargetName="ButtonInnerLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerLeftBorder}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerRightBorder}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerBottomBorder}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackground}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundHighlight}" />
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonTopBorderPressed}" />
                            <Setter TargetName="ButtonLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonLeftBorderPressed}" />
                            <Setter TargetName="ButtonRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonRightBorderPressed}" />
                            <Setter TargetName="ButtonBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonBottomBorderPressed}" />
                            <Setter TargetName="ButtonInnerLeftBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerLeftBorderPressed}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerRightBorderPressed}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="BorderBrush"
                                    Value="{DynamicResource TaskButtonInnerBottomBorderPressed}" />
                            <Setter TargetName="ButtonInnerBottomBorder"
                                    Property="Background"
                                    Value="Transparent" />
                            <Setter TargetName="ButtonTopBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundPressed}" />
                            <Setter TargetName="ButtonInnerRightBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskButtonBackgroundHighlightPressed}" />
                            <Setter TargetName="Content"
                                    Property="Margin"
                                    Value="2,3,0,3" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="Thumb"
           x:Key="ToolbarThumb"
           BasedOn="{StaticResource ToolbarThumb}">
        <Setter Property="Height"
                Value="Auto" />
        <Setter Property="Margin"
                Value="4,6,0,4" />
        <Setter Property="Width"
                Value="6" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Border Background="Transparent"
                            SnapsToDevicePixels="True">
                        <Rectangle x:Name="ThumbRect">
                            <Rectangle.Fill>
                                <DrawingBrush Viewport="0,0,6,6"
                                              ViewportUnits="Absolute"
                                              Viewbox="0,0,6,6"
                                              ViewboxUnits="Absolute"
                                              TileMode="Tile">
                                    <DrawingBrush.Drawing>
                                        <DrawingGroup>
                                            <GeometryDrawing Brush="{DynamicResource ToolbarThumbBackground}"
                                                             Geometry="M 1 1 L 1 3 L 3 3 L 3 1 z" />
                                            <GeometryDrawing Brush="{DynamicResource ToolbarThumbForeground}"
                                                             Geometry="M 0 0 L 0 2 L 2 2 L 2 0 z" />
                                            <GeometryDrawing Brush="{DynamicResource ToolbarThumbBackground}"
                                                             Geometry="M 4 4 L 4 6 L 6 6 L 6 4 z" />
                                            <GeometryDrawing Brush="{DynamicResource ToolbarThumbForeground}"
                                                             Geometry="M 3 3 L 3 5 L 5 5 L 5 3 z" />
                                        </DrawingGroup>
                                    </DrawingBrush.Drawing>
                                </DrawingBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=Orientation}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter Property="Height"
                                        Value="6" />
                                <Setter Property="Width"
                                        Value="Auto" />
                                <Setter TargetName="ThumbRect"
                                        Property="Fill">
                                    <Setter.Value>
                                        <DrawingBrush Viewport="0,0,6,6"
                                                      ViewportUnits="Absolute"
                                                      Viewbox="0,0,6,6"
                                                      ViewboxUnits="Absolute"
                                                      TileMode="Tile">
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <GeometryDrawing Brush="{DynamicResource ToolbarThumbBackground}"
                                                                     Geometry="M 0 4 L 0 6 L 2 6 L 2 4 z" />
                                                    <GeometryDrawing Brush="{DynamicResource ToolbarThumbForeground}"
                                                                     Geometry="M 1 3 L 1 5 L 3 5 L 3 3 z" />
                                                    <GeometryDrawing Brush="{DynamicResource ToolbarThumbBackground}"
                                                                     Geometry="M 3 1 L 3 3 L 5 3 L 5 1 z" />
                                                    <GeometryDrawing Brush="{DynamicResource ToolbarThumbForeground}"
                                                                     Geometry="M 4 0 L 4 2 L 6 2 L 6 0 z" />
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger.Setters>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <Setter Property="Margin"
                        Value="5,3,6,1" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="ToggleButton"
           x:Key="ShowDesktopButton">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="HorizontalAlignment"
                Value="Stretch" />
        <Setter Property="FocusVisualStyle"
                Value="{x:Null}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ToggleButton">
                    <Border BorderThickness="1,0,0,0"
                            BorderBrush="{DynamicResource TaskListScrollButtonOuterLeftBorder}"
                            x:Name="ButtonOuterLeftBorder">
                        <Border BorderThickness="0,0,0,0"
                                BorderBrush="{DynamicResource TaskListScrollButtonOuterRightBorder}"
                                x:Name="ButtonOuterRightBorder">
                            <Border BorderThickness="0,0,0,0"
                                    BorderBrush="{DynamicResource TaskListScrollButtonOuterBottomBorder}"
                                    x:Name="ButtonOuterBottomBorder">
                                <Border BorderThickness="0,0,0,0"
                                        BorderBrush="{DynamicResource TaskListScrollButtonBottomBorder}"
                                        x:Name="ButtonBottomBorder">
                                    <Border BorderThickness="1,0,0,0"
                                            BorderBrush="{DynamicResource TaskListScrollButtonLeftBorder}"
                                            x:Name="ButtonLeftBorder">
                                        <Border BorderThickness="0,0,0,0"
                                                BorderBrush="{DynamicResource TaskListScrollButtonRightBorder}"
                                                x:Name="ButtonRightBorder">
                                            <Border BorderThickness="0,1,0,0"
                                                    BorderBrush="{DynamicResource TaskListScrollButtonTopBorder}"
                                                    Background="{DynamicResource TaskListScrollButtonBackground}"
                                                    x:Name="ButtonTopBorder">
                                                <Border BorderThickness="0,0,0,1"
                                                        BorderBrush="{DynamicResource TaskListScrollButtonInnerBottomBorder}"
                                                        x:Name="ButtonInnerBottomBorder">
                                                    <Border BorderThickness="1,0,0,0"
                                                            BorderBrush="{DynamicResource TaskListScrollButtonInnerLeftBorder}"
                                                            x:Name="ButtonInnerLeftBorder">
                                                        <Border BorderThickness="0,0,1,0"
                                                                BorderBrush="{DynamicResource TaskListScrollButtonInnerRightBorder}"
                                                                x:Name="ButtonInnerRightBorder">
                                                            <ContentPresenter HorizontalAlignment="Center"
                                                                              VerticalAlignment="Center"
                                                                              Margin="5,1,3,0"
                                                                              x:Name="Content" />
                                                        </Border>
                                                    </Border>
                                                </Border>
                                            </Border>
                                        </Border>
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskListScrollButtonBackgroundHover}" />
                        </Trigger>
                        <Trigger Property="IsChecked"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskListScrollButtonBackgroundPressed}" />
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="True">
                            <Setter TargetName="ButtonTopBorder"
                                    Property="Background"
                                    Value="{DynamicResource TaskListScrollButtonBackgroundPressed}" />
                        </Trigger>
                        <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                     Value="Vertical">
                            <DataTrigger.Setters>
                                <Setter TargetName="ButtonLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,0" />
                                <Setter TargetName="ButtonTopBorder"
                                        Property="BorderThickness"
                                        Value="1,0,0,0" />
                                <Setter TargetName="ButtonRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonBottomBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,0" />
                                <Setter TargetName="ButtonInnerLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="ButtonInnerRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonInnerBottomBorder"
                                        Property="BorderThickness"
                                        Value="0,0,1,0" />
                                <Setter TargetName="ButtonOuterLeftBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,0" />
                                <Setter TargetName="ButtonOuterRightBorder"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                                <Setter TargetName="ButtonOuterBottomBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,0" />
                            </DataTrigger.Setters>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="TaskListScrollButtonGrid"
           TargetType="Grid">
        <Setter Property="Margin"
                Value="1,0" />
    </Style>

    <Style x:Key="TaskListScrollViewer"
           TargetType="ScrollViewer"
           BasedOn="{StaticResource TaskListScrollViewer}">
        <Setter Property="Margin"
                Value="4,0,0,0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ScrollViewer}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <ScrollContentPresenter Grid.Column="0"
                                                Width="{TemplateBinding Width}"
                                                Height="{TemplateBinding Height}"
                                                CanContentScroll="{TemplateBinding CanContentScroll}"
                                                Content="{TemplateBinding Content}" />
                        <Grid Grid.Column="1"
                              Style="{DynamicResource TaskListScrollButtonGrid}"
                              Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <RepeatButton Command="ScrollBar.PageUpCommand"
                                          Style="{DynamicResource TaskListScrollUpButton}"
                                          Grid.Column="0">
                                <Path Fill="{DynamicResource TaskListScrollArrow}"
                                      Data="{DynamicResource VArrow}"
                                      RenderTransformOrigin="0.5,0.5"
                                      RenderOptions.EdgeMode="Aliased">
                                    <Path.RenderTransform>
                                        <ScaleTransform ScaleY="-1" />
                                    </Path.RenderTransform>
                                </Path>
                            </RepeatButton>
                            <RepeatButton Command="ScrollBar.PageDownCommand"
                                          Style="{DynamicResource TaskListScrollDownButton}"
                                          Grid.Row="1">
                                <Path Fill="{DynamicResource TaskListScrollArrow}"
                                      Data="{DynamicResource VArrow}"
                                      RenderOptions.EdgeMode="Aliased">
                                </Path>
                            </RepeatButton>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type ScrollViewer}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <ScrollContentPresenter Grid.Row="0"
                                                            Width="{TemplateBinding Width}"
                                                            Height="{TemplateBinding Height}"
                                                            CanContentScroll="{TemplateBinding CanContentScroll}"
                                                            Content="{TemplateBinding Content}" />
                                    <Grid Grid.Row="1"
                                          Style="{DynamicResource TaskListScrollButtonGrid}"
                                          Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <RepeatButton Command="ScrollBar.PageUpCommand"
                                                      Style="{DynamicResource TaskListScrollUpButton}"
                                                      Padding="7"
                                                      Grid.Column="0">
                                            <Path Fill="{DynamicResource TaskListScrollArrow}"
                                                  Data="{DynamicResource VArrow}"
                                                  Margin="7"
                                                  RenderTransformOrigin="0.5,0.5"
                                                  RenderOptions.EdgeMode="Aliased">
                                                <Path.RenderTransform>
                                                    <ScaleTransform ScaleY="-1" />
                                                </Path.RenderTransform>
                                            </Path>
                                        </RepeatButton>
                                        <RepeatButton Command="ScrollBar.PageDownCommand"
                                                      Style="{DynamicResource TaskListScrollDownButton}"
                                                      Padding="4"
                                                      Grid.Column="1">
                                            <Path Fill="{DynamicResource TaskListScrollArrow}"
                                                  Data="{DynamicResource VArrow}"
                                                  Margin="7"
                                                  RenderOptions.EdgeMode="Aliased">
                                            </Path>
                                        </RepeatButton>
                                    </Grid>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Margin"
                            Value="0,3,0,0" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Geometry x:Key="VArrow">M 4.5 6 L 9 1.5 L 8 0 L 4.5 3 L 1 0 L 0 1.5 Z</Geometry>
    <Geometry x:Key="HArrow">M 0,4.5 L 4.5,9 L 6,8 L 3,4.5 L 6,1 L 4.5,0 Z</Geometry>

    <Style TargetType="ToggleButton"
           x:Key="TrayToggleButton">
        <Setter Property="OverridesDefaultStyle"
                Value="True" />
        <Setter Property="Background"
                Value="{DynamicResource TrayToggleBackground}" />
        <Setter Property="Margin"
                Value="-20,1,3,0" />
        <Setter Property="VerticalAlignment"
                Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ToggleButton">
                    <Border Background="Transparent">
                        <Border BorderThickness="1"
                                BorderBrush="{DynamicResource TrayToggleBorder}"
                                CornerRadius="10"
                                Background="{TemplateBinding Background}"
                                Padding="{DynamicResource TrayToggleArrowPadding}"
                                HorizontalAlignment="Center"
                                x:Name="ButtonBorder">
                            <Border Effect="{DynamicResource TrayToggleArrowOuterShadow}">
                                <Path Fill="{DynamicResource ItemButtonForeground}"
                                      Data="{DynamicResource HArrow}"
                                      RenderOptions.EdgeMode="Aliased"
                                      Effect="{DynamicResource TrayToggleArrowShadow}"
                                      x:Name="ToggleArrow" />
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="ButtonBorder"
                                    Property="Background"
                                    Value="{DynamicResource TrayToggleHoverBackground}" />
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="True">
                            <Setter TargetName="ButtonBorder"
                                    Property="Background"
                                    Value="{DynamicResource TrayTogglePressedBackground}" />
                            <Setter TargetName="ToggleArrow"
                                    Property="Fill"
                                    Value="{DynamicResource TrayToggleArrowPressed}" />
                        </Trigger>
                        <Trigger Property="IsChecked"
                                 Value="True">
                            <Setter TargetName="ToggleArrow"
                                    Property="RenderTransformOrigin"
                                    Value="0.6,0.5" />
                            <Setter TargetName="ToggleArrow"
                                    Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="-1"></ScaleTransform>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsChecked" Value="True">
                <Setter Property="ToolTip" Value="{DynamicResource hide}" />
            </Trigger>
            <Trigger Property="IsChecked" Value="False">
                <Setter Property="ToolTip" Value="{DynamicResource show_hidden}" />
            </Trigger>
            <DataTrigger Binding="{Binding Path=Orientation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                         Value="Vertical">
                <DataTrigger.Setters>
                    <Setter Property="Margin"
                            Value="0,-19,0,1" />
                </DataTrigger.Setters>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="Button"
           x:Key="NotifyBalloonCloseButton"
           BasedOn="{StaticResource NotifyBalloonCloseButton}">
        <Setter Property="Foreground"
                Value="{DynamicResource BalloonCloseButtonInactiveForeground}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border BorderBrush="{DynamicResource BalloonCloseButtonInactiveShadow}"
                            BorderThickness="0,0,1,1"
                            CornerRadius="3"
                            Name="BorderShadowDark">
                        <Border BorderBrush="{DynamicResource BalloonCloseButtonInactiveShadow}"
                                BorderThickness="1,1,0,0"
                                CornerRadius="3"
                                Name="BorderShadowLight">
                            <Border BorderBrush="{DynamicResource BalloonCloseButtonInactiveBorder}"
                                    BorderThickness="1"
                                    CornerRadius="2"
                                    Background="{DynamicResource BalloonCloseButtonInactiveBackground}"
                                    Name="Border">
                                <Border BorderBrush="{DynamicResource BalloonCloseButtonInactiveShadow}"
                                        BorderThickness="0,0,1,1"
                                        CornerRadius="2"
                                        Name="BorderInnerDark">
                                    <Border BorderBrush="{DynamicResource BalloonCloseButtonInactiveShadow}"
                                            BorderThickness="1"
                                            CornerRadius="2"
                                            Padding="3,3,0,0"
                                            Name="BorderInnerLight">
                                        <Grid x:Name="Content">
                                            <Path Stroke="{TemplateBinding Foreground}"
                                                  StrokeEndLineCap="Round"
                                                  StrokeStartLineCap="Round"
                                                  Width="8"
                                                  Height="8"
                                                  StrokeThickness="2"
                                                  Data="M 0,0 l 6,6" />
                                            <Path Stroke="{TemplateBinding Foreground}"
                                                  StrokeEndLineCap="Round"
                                                  StrokeStartLineCap="Round"
                                                  Width="8"
                                                  Height="8"
                                                  StrokeThickness="2"
                                                  Data="M 0,6 l 6,-6" />
                                        </Grid>
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="BorderShadowDark"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonActiveShadowDark}" />
                            <Setter TargetName="BorderShadowLight"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonActiveShadowLight}" />
                            <Setter TargetName="Border"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonActiveBorder}" />
                            <Setter TargetName="Border"
                                    Property="Background"
                                    Value="{DynamicResource BalloonCloseButtonHoverBackground}" />
                            <Setter TargetName="BorderInnerDark"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonHoverInnerDark}" />
                            <Setter TargetName="BorderInnerLight"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonHoverInnerLight}" />
                            <Setter Property="Foreground"
                                    Value="{DynamicResource BalloonCloseButtonActiveForeground}" />
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="True">
                            <Setter TargetName="BorderShadowDark"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonActiveShadowDark}" />
                            <Setter TargetName="BorderShadowLight"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonActiveShadowLight}" />
                            <Setter TargetName="Border"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonActiveBorder}" />
                            <Setter TargetName="Border"
                                    Property="Background"
                                    Value="{DynamicResource BalloonCloseButtonPressedBackground}" />
                            <Setter TargetName="BorderInnerDark"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonPressedInnerDark}" />
                            <Setter TargetName="BorderInnerLight"
                                    Property="BorderBrush"
                                    Value="{DynamicResource BalloonCloseButtonPressedInnerLight}" />
                            <Setter TargetName="BorderInnerDark"
                                    Property="BorderThickness"
                                    Value="1,1,0,0" />
                            <Setter Property="Foreground"
                                    Value="{DynamicResource BalloonCloseButtonActiveForeground}" />
                            <Setter TargetName="Content"
                                    Property="Opacity"
                                    Value="0.5" />
                            <Setter TargetName="Content"
                                    Property="Margin"
                                    Value="-1,-1,0,0" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>